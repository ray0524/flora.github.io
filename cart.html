<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è³¼ç‰©è»Š - FLORA</title>
    <link rel="stylesheet" href="cart.css">
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        å…¨é¤¨æ»¿ $1,500 å…é‹ ï½œ æ–°æœƒå“¡é¦–è³¼äº« 9 æŠ˜å„ªæƒ 
    </div>

    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="index.html" class="back-button">
                <div class="back-arrow">â†</div>
            </a>
            <a href="index.html" class="logo">FLORA</a>
            <div style="width: 50px;"></div>
        </div>
    </header>

    <!-- é é¢æ¨™é¡Œ -->
    <h1 class="page-title">è³¼ç‰©è»Š</h1>

    <!-- è³¼ç‰©æµç¨‹æŒ‡ç¤ºå™¨ -->
    <div class="progress-indicator">
        <div class="progress-steps">
            <div class="progress-line">
                <div class="progress-line-fill"></div>
            </div>
            <div class="step active">
                <div class="step-circle">1</div>
                <div class="step-label">è³¼ç‰©è»Š</div>
            </div>
            <div class="step">
                <div class="step-circle">2</div>
                <div class="step-label">ç¢ºèªè¨‚å–®</div>
            </div>
            <div class="step">
                <div class="step-circle">3</div>
                <div class="step-label">ä»˜æ¬¾</div>
            </div>
            <div class="step">
                <div class="step-circle">4</div>
                <div class="step-label">å®Œæˆ</div>
            </div>
        </div>
    </div>

    <!-- è³¼ç‰©è»Šå…§å®¹ -->
    <div class="cart-container">
        <!-- è³¼ç‰©è»Šé …ç›® -->
        <div class="cart-items">
            <!-- å…¨é¸/åˆªé™¤æ“ä½œåˆ— -->
            <div class="cart-actions">
                <label class="select-all">
                    <input type="checkbox" class="item-checkbox" id="select-all" onchange="toggleSelectAll()">
                    å…¨é¸
                </label>
                <button class="delete-selected" onclick="deleteSelected()">åˆªé™¤æ‰€é¸</button>
            </div>

            <!-- å•†å“1 -->
            <div class="cart-item">
                <input type="checkbox" class="item-checkbox" onchange="updateTotal()">
                <div class="item-image">ğŸŒ¿</div>
                <div class="item-info">
                    <div class="item-name">é¾œèƒŒèŠ‹</div>
                    <div class="item-spec">è¦æ ¼ï¼šä¸­å‹ç›†æ ½</div>
                </div>
                <div class="item-price">NT$ 680</div>
                <div class="quantity-control">
                    <button class="qty-btn" onclick="changeQty(this, -1)">âˆ’</button>
                    <input type="text" class="qty-input" value="1" readonly>
                    <button class="qty-btn" onclick="changeQty(this, 1)">+</button>
                </div>
                <div class="item-subtotal">NT$ 680</div>
                <button class="delete-btn" onclick="deleteItem(this)">Ã—</button>
            </div>

            <!-- å•†å“2 -->
            <div class="cart-item">
                <input type="checkbox" class="item-checkbox" onchange="updateTotal()">
                <div class="item-image">ğŸŒµ</div>
                <div class="item-info">
                    <div class="item-name">ä»™äººæŒçµ„åˆ</div>
                    <div class="item-spec">è¦æ ¼ï¼šä¸‰å…¥çµ„åˆ</div>
                </div>
                <div class="item-price">NT$ 450</div>
                <div class="quantity-control">
                    <button class="qty-btn" onclick="changeQty(this, -1)">âˆ’</button>
                    <input type="text" class="qty-input" value="2" readonly>
                    <button class="qty-btn" onclick="changeQty(this, 1)">+</button>
                </div>
                <div class="item-subtotal">NT$ 900</div>
                <button class="delete-btn" onclick="deleteItem(this)">Ã—</button>
            </div>

            <!-- å•†å“3 -->
            <div class="cart-item">
                <input type="checkbox" class="item-checkbox" onchange="updateTotal()">
                <div class="item-image">ğŸƒ</div>
                <div class="item-info">
                    <div class="item-name">ç´è‘‰æ¦•</div>
                    <div class="item-spec">è¦æ ¼ï¼šå¤§å‹ç›†æ ½</div>
                </div>
                <div class="item-price">NT$ 1,200</div>
                <div class="quantity-control">
                    <button class="qty-btn" onclick="changeQty(this, -1)">âˆ’</button>
                    <input type="text" class="qty-input" value="1" readonly>
                    <button class="qty-btn" onclick="changeQty(this, 1)">+</button>
                </div>
                <div class="item-subtotal">NT$ 1,200</div>
                <button class="delete-btn" onclick="deleteItem(this)">Ã—</button>
            </div>
        </div>

        <!-- çµå¸³æ‘˜è¦ -->
        <div class="checkout-summary">
            <h3 style="margin-bottom: 20px; color: #3d5a4a; font-weight: 400;">è¨‚å–®æ‘˜è¦</h3>
            
            <div class="summary-row">
                <span>å•†å“å°è¨ˆ</span>
                <span id="subtotal">NT$ 0</span>
            </div>
            <div class="summary-row">
                <span>é‹è²»</span>
                <span id="shipping">NT$ 0</span>
            </div>
            <div class="summary-row">
                <span>å„ªæƒ æŠ˜æ‰£</span>
                <span id="discount" style="color: #e57373;">- NT$ 0</span>
            </div>
            
            <div class="summary-total">
                <span>ç¸½è¨ˆ</span>
                <span class="amount" id="total">NT$ 0</span>
            </div>

            <button class="checkout-btn" onclick="checkout()">å‰å¾€çµå¸³</button>
            <button class="continue-shopping" onclick="location.href='index.html'">ç¹¼çºŒè³¼ç‰©</button>

            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e8ede7; font-size: 13px; color: #999; line-height: 1.8;">
                <p>âœ“ 7å¤©é‘‘è³æœŸä¿è­‰</p>
                <p>âœ“ æ»¿ $1,500 å…é‹è²»</p>
                <p>âœ“ æ–°æœƒå“¡é¦–è³¼äº« 9 æŠ˜</p>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // æ›´æ”¹å•†å“æ•¸é‡
        function changeQty(btn, change) {
            const qtyInput = btn.parentElement.querySelector('.qty-input');
            let currentQty = parseInt(qtyInput.value);
            let newQty = currentQty + change;
            
            if (newQty < 1) newQty = 1;
            if (newQty > 99) newQty = 99;
            
            qtyInput.value = newQty;
            updateItemSubtotal(btn);
            updateTotal();
        }

        // æ›´æ–°å–®é …å°è¨ˆ
        function updateItemSubtotal(element) {
            const item = element.closest('.cart-item');
            const price = parseInt(item.querySelector('.item-price').textContent.replace(/[^0-9]/g, ''));
            const qty = parseInt(item.querySelector('.qty-input').value);
            const subtotal = price * qty;
            item.querySelector('.item-subtotal').textContent = `NT$ ${subtotal.toLocaleString()}`;
        }

        // æ›´æ–°ç¸½è¨ˆ
        function updateTotal() {
            const items = document.querySelectorAll('.cart-item');
            let subtotal = 0;
            let selectedCount = 0;

            items.forEach(item => {
                const checkbox = item.querySelector('.item-checkbox');
                if (checkbox.checked) {
                    const itemSubtotal = parseInt(item.querySelector('.item-subtotal').textContent.replace(/[^0-9]/g, ''));
                    subtotal += itemSubtotal;
                    selectedCount++;
                }
            });

            // è¨ˆç®—é‹è²»ï¼ˆæ»¿1500å…é‹ï¼‰
            const shipping = subtotal >= 1500 ? 0 : 100;
            
            // è¨ˆç®—æŠ˜æ‰£ï¼ˆå‡è¨­æ–°æœƒå“¡9æŠ˜ï¼‰
            const discount = 0; // å¯ä¾éœ€æ±‚èª¿æ•´
            
            // ç¸½è¨ˆ
            const total = subtotal + shipping - discount;

            // æ›´æ–°é¡¯ç¤º
            document.getElementById('subtotal').textContent = `NT$ ${subtotal.toLocaleString()}`;
            document.getElementById('shipping').textContent = shipping === 0 ? 'å…é‹è²»' : `NT$ ${shipping}`;
            document.getElementById('discount').textContent = discount > 0 ? `- NT$ ${discount}` : 'NT$ 0';
            document.getElementById('total').textContent = `NT$ ${total.toLocaleString()}`;
        }

        // å…¨é¸/å–æ¶ˆå…¨é¸
        function toggleSelectAll() {
            const selectAllCheckbox = document.getElementById('select-all');
            const itemCheckboxes = document.querySelectorAll('.cart-item .item-checkbox');
            
            itemCheckboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
            
            updateTotal();
        }

        // åˆªé™¤å–®é …
        function deleteItem(btn) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤æ­¤å•†å“ï¼Ÿ')) {
                btn.closest('.cart-item').remove();
                updateTotal();
                checkEmptyCart();
            }
        }

        // åˆªé™¤æ‰€é¸
        function deleteSelected() {
            const selected = document.querySelectorAll('.cart-item .item-checkbox:checked');
            if (selected.length === 0) {
                alert('è«‹å…ˆé¸æ“‡è¦åˆªé™¤çš„å•†å“');
                return;
            }
            
            if (confirm(`ç¢ºå®šè¦åˆªé™¤ ${selected.length} ä»¶å•†å“ï¼Ÿ`)) {
                selected.forEach(checkbox => {
                    checkbox.closest('.cart-item').remove();
                });
                updateTotal();
                checkEmptyCart();
            }
        }

        // æª¢æŸ¥è³¼ç‰©è»Šæ˜¯å¦ç‚ºç©º
        function checkEmptyCart() {
            const items = document.querySelectorAll('.cart-item');
            if (items.length === 0) {
                document.querySelector('.cart-items').innerHTML = `
                    <div class="empty-cart">
                        <div class="empty-cart-icon">ğŸ›’</div>
                        <div class="empty-cart-text">æ‚¨çš„è³¼ç‰©è»Šæ˜¯ç©ºçš„</div>
                        <button class="checkout-btn" style="max-width: 300px; margin: 0 auto;" onclick="location.href='index.html'">
                            å‰å¾€é¸è³¼
                        </button>
                    </div>
                `;
            }
        }

        // å‰å¾€çµå¸³
        function checkout() {
            const selected = document.querySelectorAll('.cart-item .item-checkbox:checked');
            if (selected.length === 0) {
                alert('è«‹å…ˆé¸æ“‡è¦çµå¸³çš„å•†å“');
                return;
            }
            alert('å³å°‡å‰å¾€çµå¸³é é¢...');
            // é€™è£¡å¯ä»¥å°å‘çµå¸³é é¢
            // window.location.href = 'checkout.html';
        }

        // é é¢è¼‰å…¥æ™‚æ›´æ–°ç¸½è¨ˆ
        window.addEventListener('load', () => {
            // é è¨­å…¨é¸
            document.getElementById('select-all').checked = true;
            toggleSelectAll();
        });
    </script>
</body>
</html>